"use strict";function sendPost(){var t=document.getElementById("titulo").value,e=document.getElementById("tags").value,o=tinymce.get("text").getContent(),n=JSON.stringify({request:[{method:"createDoc",collection:"posts",values:{titulo:t,tags:e,texto:makeJsonStr(o)}}]});if(1==auth){var s=!0;titulos.forEach(function(e){t==e&&(alert("titulo j√° existe"),s=!1)},this),1==s&&ws.send(n)}return!1}function makeJsonStr(t){return t=t.replace(/"/g,'\\"'),t=t.replace(/\n/g,"")}var titulos=[],auth=!1;ws.onopen=function(){var t=JSON.stringify({request:[{method:"find",collection:"posts",values:{titulo:""}}],loopRequest:!0});ws.send(t)},ws.onmessage=function(t){var e=JSON.parse(t.data);if(1==e[0].create)window.location.replace("/");else if(e[0].err)alert(e[0].err);else{var o=[];auth=!0,e.forEach(function(t){t.forEach(function(t){o.push(t.titulo)},this)},this),titulos=o}},ws.onclose=function(){$("#new").append("<p>Socket closed</p>")};